<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecom.javacodings.merchandiser.access.ItemManagerDAO">
<!-- Region Create -->
<!-- End Region Create -->
<!-- Region Read -->
	<select id="listItem" parameterType="pageDTO">
		SELECT *
		FROM
		(
			SELECT ITEM_ID, LABEL, "DESC", CATEGORY, IMAGE, PRICE, STOCK,
			       ROW_NUMBER() over (ORDER BY REG_DATE DESC) AS RN
			FROM ITEMS
	  	)
		WHERE RN BETWEEN #{start} AND #{end}
	</select>

	<select id="getItemById" parameterType="String" resultType="itemDTO">
		SELECT ITEM_ID, LABEL, "DESC", IMAGE, PRICE, STOCK, CATEGORY
		FROM ITEMS
		WHERE ITEM_ID = #{value}
	</select>

	<select id="listCategory" resultType="String">
		SELECT CATEGORY FROM ITEMS GROUP BY CATEGORY
	</select>

	<select id="countItems" resultType="int">
		SELECT COUNT(ITEM_ID) FROM ITEMS
	</select>
<!-- End Region Read -->
<!-- Region Update -->
	<update id="updateItem" parameterType="ItemDTO">
		UPDATE ITEMS
		SET
		<if test="category!=null">CATEGORY=#{category}, </if>
		<if test="label!=null">LABEL=#{label}, </if>
		<if test="desc!=null">"DESC"=#{desc}, </if>
		<if test="image!=null">IMAGE=#{image}, </if>
		<if test="price!=null">PRICE=#{price}, </if>
		<if test="stock!=null">STOCK=#{stock} </if>
		WHERE ITEM_ID=#{item_id}
	</update>
<!-- End Region Update -->
<!-- Region Delete -->
	<delete id="deleteItem" parameterType="string">
		DELETE
		FROM ITEMS
		WHERE ITEM_ID = #{value}
	</delete>
<!-- End Region Delete -->
</mapper>